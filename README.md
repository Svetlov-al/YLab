## YLab Project

Это пример приложения меню, написанного на Python и развернутого в Docker.

### Возможности
CRUD операции для меню, подменю и блюд
Вложенная структура меню, которая позволяет иметь подменю, а подменю иметь блюда.
Детали меню и подменю включают количество связанных подменю и блюд.
REST API со всеми endpoint для CRUD операций.
Документация Swagger/OpenAPI.
Docker контейнер для простого развертывания.
Конечные точки API.

В проект встроен ```Redis``` для кеширования ```GET``` запросов.

Для принудительной инвалидации кеша можно использовать `POST` запрос!

### Запрос по адресу
### `POST /api/v1/invalidate`,
Реализована функция через `background task`, данный функционал можно расширить.


## API имеет следующие конечные точки:

### Добавлен новый маршрут для отображения всех меню, сабменю, и блюд по типу матрешки!

```GET /api/v1```

### Меню

```GET /api/v1/menus``` - получить список всех меню

```GET /api/v1/menus/{id}``` - получить конкретное меню

```POST /api/v1/menus``` - создать новое меню

```PATCH /api/v1/menus/{id}``` - обновить существующее меню

```DELETE /api/v1/menus/{id}``` - удалить меню

### Подменю

```GET /api/v1/menus/{menu_id}/submenus``` - получить список всех подменю для меню

```GET /api/v1/menus/{menu_id}/submenus/{id}``` - получить конкретное подменю

```POST /api/v1/menus/{menu_id}/submenus``` - создать новое подменю для меню

```PATCH /api/v1/menus/{menu_id}/submenus/{id}``` - обновить существующее подменю

```DELETE /api/v1/menus/{menu_id}/submenus/{id}``` - удалить подменю

## Блюда

```GET /api/v1/menus/{menu_id}/submenus/{submenu_id}/dishes``` - получить список всех блюд для подменю

```GET /api/v1/menus/{menu_id}/submenus/{submenu_id}/dishes/{id}``` - получить конкретное блюдо

```POST /api/v1/menus/{menu_id}/submenus/{submenu_id}/dishes``` - создать новое блюдо для подменю

```PATCH /api/v1/menus/{menu_id}/submenus/{submenu_id}/dishes/{id}``` - обновить существующее блюдо

```DELETE /api/v1/menus/{menu_id}/submenus/{submenu_id}/dishes/{id}``` - удалить блюдо


### Запуск приложения
Приложение запускается в Docker контейнере для простого развертывания.

### Для сборки:
Убедитесь, что у вас установлены Docker и Docker Compose. Вы можете установить Docker Desktop, который включает в себя Docker Compose, с официального сайта Docker.

Откройте терминал (или командную строку в Windows) и перейдите в каталог, где находится файл `docker-compose.yml`

### Для запуска: Введите следующую команду:

`docker-compose up -d`

### Для остановки:

`docker-compose down`

### Для запуска тестов в контейнере создан отдельный docker-compose-test.yml файл.
Запустить тесты можно командой:
`docker-compose -f docker-compose-tests.yml run api-tests`

Для остановки тестового контейнера:
`docker-compose -f docker-compose-tests.yml down`

### Для запуска контейнера под фоновым управленим Celery создан отдельный docker-compose-celery-rabbit.yml файл.
<b>Данный контейнер работает под управлением Celery, и читает файл в папке admin в корневом каталоге.
В случае если в базе отсутсвуют данные о меню, сабюменю, блюдах, скрипт считывает данные с Exel файла,
и записывает в базу, и обновляет базу данными из файла в установленное время.
Соответственно любое изменение цены, описания блюда или его название, приведет к автоматическому обновлению в базе.</b>

### Запускать контейнер через ->
 `docker-compose -f docker-compose-celery-rabbit.yml up`


### API будет доступен по адресу http://localhost:8000

### Документация OpenAPI/Swagger доступна по адресу http://localhost:8000/docs
